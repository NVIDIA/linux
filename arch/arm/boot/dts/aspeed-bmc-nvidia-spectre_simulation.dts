// SPDX-License-Identifier: GPL-2.0+
/dts-v1/;

#include "aspeed-g6.dtsi"
#include <dt-bindings/gpio/aspeed-gpio.h>
#include <dt-bindings/leds/common.h>
#include <dt-bindings/i2c/i2c.h>
#include "aspeed-g6-pinctrl.dtsi"

/ {
	model = "AST2600 Spactre";
	compatible = "aspeed,ast2600";

	aliases {
		serial4 = &uart5;
	};

	chosen {
		stdout-path = &uart5;
		bootargs = "console=tty0 console=ttyS4,115200 earlyprintk";
	};

	memory@80000000 {
		reg = <0x80000000 0x40000000>;
	};

	power-gpios{
				n2-gpios = <&gpio0 ASPEED_GPIO(N, 2) (GPIO_ACTIVE_HIGH|GPIO_PULL_UP)>;
				n3-gpios = <&gpio0 ASPEED_GPIO(N, 3) (GPIO_ACTIVE_HIGH|GPIO_PULL_UP)>;
	};

	iio-hwmon {
		compatible = "iio-hwmon";
		io-channels = <&adc0 0>, <&adc0 1>, <&adc0 2>, <&adc0 3>,
						<&adc0 4>, <&adc0 5>, <&adc0 6>, <&adc0 7>,
						<&adc1 0>, <&adc1 1>, <&adc1 2>, <&adc1 3>,
						<&adc1 4>, <&adc1 5>, <&adc1 6>, <&adc1 7>;
	};

};

&adc0 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_adc0_default
				&pinctrl_adc1_default
				&pinctrl_adc2_default
				&pinctrl_adc3_default
				&pinctrl_adc4_default
				&pinctrl_adc5_default
				&pinctrl_adc6_default
				&pinctrl_adc7_default>;
};

&adc1 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_adc8_default
				&pinctrl_adc9_default
				&pinctrl_adc10_default
				&pinctrl_adc11_default
				&pinctrl_adc12_default
				&pinctrl_adc13_default
				&pinctrl_adc14_default
				&pinctrl_adc15_default>;
};


&gpio0 {
		gpio-line-names =
		/*A0-A7*/		"","","","","","","","",
		/*B0-B7*/		"","","","","","","","",
		/*C0-C7*/		"","","","","","","","",
		/*D0-D7*/		"","","","","","","","",
		/*E0-E7*/		"","","","","","","","",
		/*F0-F7*/		"","","","","","","","",
		/*G0-G7*/		"","","","","","","","",
		/*H0-H7*/		"","","","","","","","",
		/*I0-I7*/		"","","","","","","","",
		/*J0-J7*/		"","","","","","","","",
		/*K0-K7*/		"","","","","","","","",
		/*L0-L7*/		"","","","","","","","",
		/*M0-M7*/		"","","","","","","","",
		/*N0-N7*/		"","","","","","","","",
		/*O0-O7*/		"pwm0","pwm1","","","","mv_switch_reset1","","mv_switch_reset0",
		/*P0-P7*/		"","","","","","","","",
		/*Q0-Q7*/		"","","","","","","","",
		/*R0-R7*/		"","","","","","","","",
		/*S0-S7*/		"","","","","","","","",
		/*T0-T7*/		"","","","","","","","",
		/*U0-U7*/		"","","","","","","","",
		/*V0-V7*/		"","","","","","","","",
		/*W0-W7*/		"","","","","","","","",
		/*X0-X7*/		"","","","","","","","",
		/*Y0-Y7*/		"","","","","","","","",
		/*Z0-Z7*/		"","","","","","","","";

		//set Fan PWM to constant "0" (full drive , 100%)
		pwm0_fan {
			gpio-hog;
			gpios = <112 GPIO_ACTIVE_LOW>;
			output-high;
		};
		pwm1_fan {
			gpio-hog;
			gpios = <113 GPIO_ACTIVE_LOW>;
			output-high;
		};
};

&gpio1 {
		gpio-line-names =
		/*AA0-AA7*/		"","","","","","","","",
		/*AB0-AB7*/		"","","","","","","","",
		/*AC0-AC7*/		"","","","","","","","",
		/*AD0-AD7*/		"","","","","","","","",
		/*AE0-AE7*/		"","","","","","","","";
};

&fmc {
	status = "okay";
	flash@0 {
		status = "okay";
		compatible = "jedec,spi-nor";
		label = "bmc";
		spi-max-frequency = <50000000>;

		partitions {
			compatible = "fixed-partitions";
			#address-cells = <1>;
			#size-cells = <1>;

			u-boot@0 {
				reg = <0x0 0xe0000>; // 896KB
				label = "u-boot";
			};

			kernel@100000 {
				reg = <0x100000 0x900000>; // 9MB
				label = "kernel";
			};

			rofs@a00000 {
				reg = <0xa00000 0x2500000>; // 37MB
				label = "rofs";
			};
		};
	};
};

&fmcraw {
	status = "okay";
	spidev@0 {
		compatible = "hgx,glacier";
		status = "okay";
	};
};

&spi2 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_spi2_default>;

	flash@0 {
		status = "okay";
		label = "config";
		spi-max-frequency = <50000000>;
		partitions {
			compatible = "fixed-partitions";
			#address-cells = <1>;
			#size-cells = <1>;

			u-boot-env@0 {
				reg = <0x0 0x40000>;	// 0.25 MB
				label = "u-boot-env";
			};

			rwfs@40000 {
				reg = <0x40000 0x1000000>;	// 16 MB
				label = "rwfs";
			};

			rwfs_failover@1040000 {
				reg = <0x1040000 0x400000>;	// 4 MB
				label = "rwfs_failover";
			};

			images_primary@1440000 {
				reg = <0x1440000 0x2400000>;	// 36 MB
				label = "images_primary";
			};

			images_secondary@3840000 {
				reg = <0x3840000 0x2400000>; // 36 MB

				label = "images_secondary";
			};

			log@5C40000 {
				reg = <0x5C40000 0x23C0000>;	// 35.75
				label = "log";
			};
		};
	};
};


&rtc {
	status = "okay";
};

&uart3 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_txd3_default &pinctrl_rxd3_default>;

};

&uart5 {
	// BMC Debug Console
	status = "okay";
};

&mdio2 {
	status = "okay";
};

&mac2 {
	status = "okay";

	pinctrl-names = "default";
	phy-mode = "rgmii";
	pinctrl-0 = <&pinctrl_rgmii3_default>;
        fixed-link {
                speed = <1000>;
                full-duplex;
        };
};

// fru eeprom
&i2c2 {
	status = "okay";
	eeprom@50 {
		compatible = "st,24c128", "atmel,24c128";
		reg = <0x50>;
		pagesize = <64>;
	};
};

//external RTC i2c
&i2c6 {
	status = "okay";
	rtc@32 {
		compatible = "epson,rx8130";
		reg = <0x32>;
	};
};

//Glacier i2c
&i2c15 {
	status = "okay";
};

&ehci0 {
	status = "okay";
};
